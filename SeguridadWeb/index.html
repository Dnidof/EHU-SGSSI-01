<!DOCTYPE html>
<html lang="en">
<head>
    <title>Seguridad en Sistemas Web</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="../ShowerTemplate/shower/themes/ribbon/styles/styles.css">
    <style>
        .shower {
            --slide-ratio: calc(16 / 9);
        }
    </style>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async
            src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
    </script>
</head>
<body class="shower list">
    <header class="caption">
        <h1>Seguridad en Sistemas Web</h1>
        <p>Mikel Egaña Aranguren</p>
    </header>

    <section class="slide" id="cover">
        <h2>Seguridad en Sistemas Web</h2>
        <p>Mikel Egaña Aranguren</p>
        <p><a href="https://mikel-egana-aranguren.github.io/">mikel-egana-aranguren.github.io</a></p>
        <p><a href="mailto:mikel.egana@ehu.eus">mikel.egana@ehu.eus</a></p>
        <img src="../ShowerTemplate/pictures/ehu.png" alt="UPV/EHU ingenieros San Mames" height="25%" border="1px solid #555">
    </section>

    <section class="slide">
        <h2>Seguridad en Sistemas Web</h2>
        <p><a href="https://doi.org/10.5281/zenodo.4302267">https://doi.org/10.5281/zenodo.4302267</a></p>
        <p><a href="https://github.com/mikel-egana-aranguren/EHU-SGSSI-01">https://github.com/mikel-egana-aranguren/EHU-SGSSI-01</a></p>
        <img src="../ShowerTemplate/pictures/by.png" alt="Creative Commons BY" height="10%">
    </section>

    <section class="slide">
        <h2>Pen-testing</h2>
        Penetration testing: intentar penetrar en un sistema utilizando las mismas herramientas que un potencial atacante, para descubrir vulnerabilidades  y arreglarlas<br><br>
    </section>


    <section class="slide">
        <h2>Principales vulnerabilidades en Sistemas Web</h2>
        La <a href="https://owasp.org/">Open Web Application Security Project (OWASP)</a> analiza las vulnerabilidades más comunes<br><br>
        Informe periódico: OWASP Top Ten (<del>2017</del>, <a href="https://owasp.org/Top10/">2021</a>)
    </section>

    <section class="slide">
    <h2>Principales vulnerabilidades en Sistemas Web</h2>
    <p><img  style="border: 1px solid #555;"  src="pictures-sgssi-01/owasp-top-10.png" alt="OWASP Top 10 2017 2021" width="70%"></p>
    </section>


    <section class="slide">
        <h2>A01:2021 - Rotura de control de acceso (Broken Access control)</h2>
        <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">https://owasp.org/Top10/A01_2021-Broken_Access_Control/</a>
        <ul>
            <li>CWE-200: Exposure of Sensitive Information to an Unauthorized Actor</li>
            <li>CWE-201: Insertion of Sensitive Information Into Sent Data</li>
            <li>CWE-352: Cross-Site Request Forgery</li>
            <li>...</li>
        </ul>
    </section>

    <section class="slide">
        <h2>A01:2021 - Rotura de control de acceso (Broken Access control)</h2>
        <p>El control de acceso obliga al usuario a actuar solo dentro de los límites establecidos por los permisos definidos</p>
        <p>Fallar en el control de acceso resulta en consecuencias graves</p>
    </section>

    <section class="slide">
        <h2>A01:2021 - Broken Access control - vulnerabilidades</h2>
        <p>Violación del principio de "denegación por defecto": el acceso solo debería ser garantizado a ciertas capacidades, roles, o usuarios, pero está al alcance de cualquiera</p>
        <p><img  style="border: 1px solid #555;"  src="pictures-sgssi-01/GAUR-guias-docentes-rotura-control-acceso.png" alt="En el mantenimiento de las guias docentes de GAUR el primer profesor que acceda a la guia, aunque no tenga permisos, se queda con la guia y la puede modificar si quiere" title="En el mantenimiento de las guias docentes de GAUR el primer profesor que acceda a la guia, aunque no tenga permisos, se queda con la guia y la puede modificar si quiere" width="70%"></p>
    </section>

    <section class="slide">
        <h2>A01:2021 - Broken Access control - vulnerabilidades</h2>
        <p>Burlar el control de acceso mediante parametros URL o las peticiones APIs</p>
        <p>Acceder a una cuenta personal e incluso modificar los datos con el identificador del usuario</p>
        <p>Acceso API sin control para los metodos HTTP POST, PUT, y DELETE</p>
        <p><b>Elevación de privilegio:</b> acutar como administrador estando logeado como usuario</p>
        <p>Replaying o modificación de JSON Web Token (JWT) para elevar privilegios</p>
        <p>Mala configuración de CORS permite acceso API desde origenes no autorizados</p>
    </section>

    <section class="slide">
        <h2>A01:2021 - Broken Access control - prevención</h2>
        <p>Burlar el control de acceso mediante parametros URL o las peticiones APIs</p>
        <p>Acceder a una cuenta personal e incluso modificar los datos con el identificador del usuario</p>
        <p>Acceso API sin control para los metodos HTTP POST, PUT, y DELETE</p>
        <p><b>Elevación de privilegio:</b> acutar como administrador estando logeado como usuario</p>
        <p>Replaying o modificación de JSON Web Token (JWT) para elevar privilegios</p>
        <p>Mala configuración de CORS permite acceso API desde origenes no autorizados</p>
    </section>



    <!-- <section class="slide">
        <h2>A1 - Inyección</h2>
        Datos no confiables son enviados como parte de una consulta a un intérprete<br>
        Se puede engañar al intérprete y lograr acceso a datos no autorizados<br>
        El más conocido SQL Injection <br>
        <a href="https://owasp.org/www-project-top-ten/2017/A1_2017-Injection.html">A1:2017-Injection</a> <br>
        <a href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05-Testing_for_SQL_Injection">Testing for SQL injection</a>

    </section>

        <section class="slide">
            <h2>A1 - Inyección</h2>
            <p><img  style="border: 1px solid #555;"  src="pictures-sgssi-01/injection.png" alt="Ejemplo Arquitectura Seguridad" width="70%"></p>
            <a href="https://securityboulevard.com/2019/06/sql-injection-attacks-so-old-but-still-so-relevant-heres-why-charts/">SQL Injection Attacks: So Old, but Still So Relevant. Here’s Why (Charts)</a>
    
        </section>

        <section class="slide">
            <h2>A1 - Inyección</h2>
        ¿Como evitarla?
        <ul>
            <li>Validación de las entradas evitando caracteres "peligrosos"</li>
            <li>No usar cuentas con privilegios de administrador</li>
            <li>No proporcionar mayor información de la necesaria (evitar la
                información de los errores hacia el usuario)</li>
            <li>No construir las sentencias SQL directamente con los valores
                recogidos, usar sentencias parametrizadas</li>
        </ul>
    
        </section>

        <section class="slide">
            <h2>A1 - Inyección</h2>
        ¿Como evitarla? Filtrar los datos
        <ul>
            <li>Si tenemos en nuestro formulario el campo username, y sabemos
                que los usuarios sólo pueden estar compuestos por letras y
                números, no se deben permitir caracteres como " ' " o " = "</li>
            <li>Si se trata del campo e-mail, podemos utilizar expresiones
                regulares para validarlo, como
                preg_match('/^.+@.+\..{2,3}$/',$_POST['email'])</li>
        </ul>
    
        </section>


        <section class="slide">
            <h2>A1 - Inyección</h2>
        ¿Como evitarla? Filtrar los datos
        <ul>
            <li>Usar funciones que escapan caracteres especiales de una
                cadena para su uso en una sentencia SQL:
                mysql_real_escape_string() coloca barras invertidas antes de los
                siguientes caracteres: \x00, \n, \r, \, ', " y \x1a</li>
            <li>addslashes(), (la directiva de PHP magic_quotes_gpc está activada
                por defecto, y ejecuta la función addslashes() en todos los datos GET,
                POST, y COOKIE)</li>
        </ul>
    
        </section>


        <section class="slide">
            <h2>A2 - Pérdida de autenticación</h2>
            Aprovecharse de una sesión establecida por un usuario legítimo <br>
            Si se usan identificadores de sesión visibles se puede copiar y usarlo a posteriori<br>
            Si se almacena el identificador de sesión en una cookie, se puede acceder a él
            <ul>
                <li>A través de un ataque XSS (ver vulnerabilidad A7)</li>
                <li>A través de una escucha en la red</li>
            </ul>
        </section>

        <section class="slide">
            <h2>A2 - Pérdida de autenticación</h2>
            Si la sesión no se cierra se puede acceder a la misma url cuando el usuario legítimo haya abandonado su máquina<br/>
        </section>

        <section class="slide">
            <h2>A2 - Pérdida de autenticación</h2>
            Posibles causas
            <ul>
                <li>Uso de passwords sencillos y conocidos (1234, admin, etc.)</li>
                <li>Uso de preguntas de seguridad sencillas o poco configurables</li>
                <li>Las contraseñas no se encriptan con un algoritmo seguro</li>
                <li>Se muestra la contraseña en la url</li>
                <li>Incorrecta gestión de las sesiones</li>
            </ul>
        </section>

        <section class="slide">
            <h2>A2 - Pérdida de autenticación</h2>
            Problemas de las cookies
            <ul>
                <li>Si almacenan los datos de la sesión de manera permanente,
                    cualquiera puede acceder a ellos</li>
                <li>Con un lenguaje de script se puede acceder al fichero y a sus
                    valores mientras se navega por el sitio web</li>
                <li>Si los datos de la cookie se envían sin cifrar, cualquiera puede
                        escucharlos por la red</li>
            </ul>
        </section>

        <section class="slide">
            <h2>A2 - Pérdida de autenticación</h2>
            ¿Cómo evitarla?
            <ul>
                <li>Cerrar la sesión cuando el usuario se desloguea</li>
                <li>Cerrar la sesión cuando el usuario pasa cierto tiempo sin hacer nada (timeout)</li>
                <li>Para evitar el acceso mediante lenguajes de Script, usar el atributo <b>httponly</b></li>
            </ul>
        </section>

        <section class="slide">
            <h2>A2 - Pérdida de autenticación</h2>
            <a href="https://haveibeenpwned.com/">';--have i been pwned?</a>
    
        </section>

        <section class="slide">
            <h2>A3 - Exposición de datos sensibles</h2>
            No tomar medidas de protección para aquellos datos que se consideren sensibles en la aplicación
            <ul>
                <li>Almacenamiento de datos sensibles sin cifrar</li>
                <li>Transmisión de datos sensibles sin cifrar</li>
                <li>Uso de algoritmos de cifrado débiles</li>
            </ul>
        </section>

        <section class="slide">
            <h2>A3 - Exposición de datos sensibles</h2>
            ¿Cómo evitarla?
            <ul>
                <li>Almacenando cifrada la información sensible</li>
                <li>Asegurando que la información sensible se envíe a través de protocolos seguros</li>
                <li>Usando algoritmos de cifrado robustos</li>
            </ul>
        </section>

        <section class="slide">
            <h2>A4 - Entidades XML externas </h2>
            Aprovecharse de vulnerabilidades en los procesadores de XML que incluyen muchos servicios web<br>
            <ul>
                <li>Subiendo ficheros XML con código embebido</li>
                <li>Haciendo uso de las dependencias de los ficheros XML</li>
            </ul>
        </section>

        <section class="slide">
            <h2>A4 - Entidades XML externas </h2>
            ¿Cómo evitarla?
            <ul>
                <li>Evitar el uso del formato XML (Usar JSON)</li>
                <li>Validar todo fichero XML antes de procesarlo</li>
                <li>Actualizar los procesadores de XML para evitar vulnerabilidades conocidas</li>
                <li>Limitar los orígenes desde los que se pueden enviar ficheros XML</li>
            </ul>
        </section>





        <section class="slide">
            <h2>A6 - Configuración de seguridad incorrecta </h2>
            No tener una buena configuración de la aplicación por desconocimiento/despiste/dejadez
            <ul>
                <li>¿Se mantienen las cuentas/servicios que se crean por defecto?</li>
                <li>¿Están habilitadas funcionalidades que no deberían?</li>
                <li>¿Se trabaja con usuarios con permisos de administrador?</li>
                <li>¿Se trabaja con software sin actualizar?</li>
                <li>¿Se permite el uso de malas contraseñas?</li>
            </ul>
        </section>

        <section class="slide">
            <h2>A6 - Configuración de seguridad incorrecta </h2>
            ¿Cómo evitarla?
            <ul>
                <li>Eliminar aquellas cuentas de servicios que no se usen</li>
                <li>Modificar las contraseñas que traen por defecto muchos
                    programas</li>
                <li>Deshabilitar puertos/servicios que no se usen</li>
                <li>Actualizar las aplicaciones</li>
                <li>Obligar a los usuarios a usar contraseñas "seguras"</li>
            </ul>
        </section>

        <section class="slide">
            <h2>A6 - Configuración de seguridad incorrecta </h2>
            ¿Cómo evitarla?
            <ul>
                <li>Definir usuarios específicos para cada aplicación con los
                    permisos correspondientes a esa aplicación (En MySQL, no usar el usuario root para las conexiones. Crear uno o varios usuarios para
                    la aplicación con los permisos que correspondan sólo sobre las tablas que correspondan)</li>
            </ul>
        </section>

        <section class="slide">
            <h2>A7 - Secuencia de comandos en sitios cruzados (XSS) </h2>
            Ejecutar código en lenguaje Script que pueda introducir el propio usuario <br>
            El método más sencillo, a través de campos de formularios <br>
            Puede ser persistentes si se almacena el script en una base de datos:
            <ul>
                <li>Se introduce como un campo que se almacena</li>
                <li>Se ejecuta cada vez que se muestra el valor de ese campo</li>
            </ul>
        </section>

        <section class="slide">
            <h2>A7 - Secuencia de comandos en sitios cruzados (XSS) </h2>
            ¿Cómo evitarla?
            <ul>
                <li>Limpiando (escapando) el texto que introduzca el usuario
                    eliminando los caracteres “peligrosos”</li>
                <li>Limpiando los valores que obtengamos de la URL eliminando los
                    caracteres “peligrosos”</li>
                <li>Existen funciones que realizan el trabajo de escapado
                    devolviendo un texto “limpio”</li>
            </ul>
        </section>

        <section class="slide">
            <h2>A8 - Deserialización insegura </h2>
            Aprovecharse del proceso de desempaquetado de datos introduciendo datos falsos /maliciosos <br><br>
            Cuando los datos vienen en formatos que los procesan para construir objetos a partir de ellos se pueden introducir datos que generen objetos no deseados 
        </section>

        <section class="slide">
            <h2>A8 - Deserialización insegura </h2>
            ¿Cómo evitarla?
            <ul>
                <li>Usando formatos que sólo admitan datos en tipos de datos primitivos (string, int, etc.), por ejemplo JSON</li>
                <li>Desempaquetando sólo datos que vengan firmados</li>
                <li>Deserializando únicamente los datos que vengan de orígenes fiables</li>
                <li>Ejecutando el proceso de deserialización de manera externa al resto de la aplicación y en un entorno controlado</li>
            </ul>
        </section>

        <section class="slide">
            <h2>A9 - Uso de componentes con vulnerabilidades conocidas </h2>
            ¿Cómo evitarla?
            <ul>
                <li>Estando al día de la publicación de vulnerabilidades</li>
                <li>Aplicando los parches correspondientes en cuanto salgan</li>
                <li>Buscando alternativas que no presenten vulnerabilidades</li>
            </ul>
        </section>

        <section class="slide">
            <h2>A10 - Logueo y monitorización insuficientes </h2>
            No registrar los intentos de acceso tanto si tienen éxito como si no<br>
            La información de los intentos de acceso puede ser muy valiosa
            <ul>
                <li>Para detectar conductas sospechosas (empleados accediendo al
                    sistema cuando no deben)</li>
                <li>Para detectar ataques (múltiples intentos fallidos con el mismo
                    usuario)</li>
                <li>En algunos casos es obligatorio almacenar esta información
                    debido a la LOPD</li>
            </ul>
        </section>

        <section class="slide">
            <h2>A10 - Logueo y monitorización insuficientes </h2>
            ¿Cómo se soluciona?
            <ul>
                <li>Almacenando la información referente a las conexiones exitosas
                    y a las fallidas</li>
                <li>Analizando la información sobre las conexiones</li>
                <li>Bloqueando al usuario si tiene X intentos fallidos consecutivos</li>
            </ul>
        </section> -->



        


    
    <!-- FOOTER -->

    <footer class="badge">
        <a href="https://github.com/mikel-egana-aranguren/EHU-SGSSI-01">Fork me on GitHub</a>
    </footer>

    <div class="progress"></div>

    <script src="../ShowerTemplate/shower/shower.js"></script>
    <!-- Copyright © 3000 Yours Truly, Famous Inc. -->

</body>
</html>
